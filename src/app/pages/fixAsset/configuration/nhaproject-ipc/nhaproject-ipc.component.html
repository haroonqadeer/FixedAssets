<div class="row">
  <div class="col-md-12 text-center">
    <h1>Asset Project IPC</h1>
  </div>
</div>
<div class="loader" *ngIf="loadingBar">Loading...</div>

<!-- container -->
<div class="container-fluid boxShadow-1 bg-white" *ngIf="!loadingBar">
  <div class="row">
    <!-- entry form -->
    <div class="col-md-4 pl-3 pr-0 border-right">
      <div class="row bgGrey">
        <div class="col-md-12 pt-4">
          <h3 class='text-white pb-2'>{{heading}} Project IPC</h3>
        </div>
      </div>
      <div class="row pr-4 pl-1">
        <div class="col-md-12 pt-2">
          <mat-form-field class='w-100'>
            <mat-label>Select Project</mat-label>
            <mat-select [(ngModel)]="cmbProject">
              <ngx-mat-select-search [(ngModel)]="searchProject" [placeholderLabel]="'Search...'"
                [noEntriesFoundLabel]="'Not found'" name="search"></ngx-mat-select-search>
              <mat-option *ngFor="
              let item of projectList" [value]="item.projectID | search
              : 'projectName'
              : searchProject">{{item.projectName}}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>

      <!-- next row -->
      <div class="row pr-4 pl-1">
        <div class="col-md-12 pt-2">
          <mat-form-field class="w-100">
            <mat-label>Package No.</mat-label>
            <input matInput placeholder="in roman e.g I, II, III, IV" [(ngModel)]="txtPkgNo">
          </mat-form-field>
        </div>
      </div>
      <div class="row pr-4 pl-1">
        <div class="col-md-12 pt-2">
          <mat-form-field class="w-100">
            <mat-label>IPC No.</mat-label>
            <input matInput type='number' [(ngModel)]="txtIPCNo">
          </mat-form-field>
        </div>
      </div>
      <!-- next row -->
      <div class="row pr-4 pl-1">
        <div class="col-md-12 pt-2">
          <mat-form-field class="w-100">
            <mat-label>Description</mat-label>
            <textarea matInput placeholder="" [(ngModel)]="txtIpcDesc"></textarea>
          </mat-form-field>
        </div>
      </div>
      <div class="row pr-4 pl-1">
        <div class="col-md-12 pt-2">
          <div class="custom-file">
            <input type="file" class="custom-file-input" [(ngModel)]="imgFile" (change)="onFileSelected($event)">
            <label class="custom-file-label" for="customFile">Choose IPC Scan Copy</label>
          </div>
        </div>
      </div>
      <div class="row pr-4 pl-1">
        <div class="col-md-12 pt-2 text-center">
          <div class="text-center">
            <img [src]="imageUrl" class="rounded" width="80" height="80" id="myImg">
          </div>
        </div>
      </div>
      <div class="row pr-4 pl-1">
        <div class="col-md-3 pt-2">
          <button mat-button mat-raised-button color="primary" class='noneOutline w-100' (click)="save()">Save</button>
        </div>
        <div class="col-md-3 pt-2">
          <button mat-button mat-raised-button color="warn" class='noneOutline w-100' (click)="clear()">Reset</button>
        </div>
      </div>
      <br>
    </div>
    <!-- saved locations -->
    <div class="col-md-8 bg-light">
      <div class="row">
        <div class="col-md-12 pt-2">
          <mat-form-field class="w-100">
            <mat-label>search...</mat-label>
            <mat-icon matPrefix class='fa fa-search' [(ngModel)]="tblSearch"></mat-icon>
            <input matInput>
          </mat-form-field>
        </div>
      </div>
      <div class="table-responsive border table-wrapper mx-auto mb-2 style-3" style='height: 450px;'>
        <table class="table table-striped">
          <thead>
            <tr>
              <th class="sticky-top" scope='col'>#</th>
              <th class="sticky-top" scope='col'>Project Short Name</th>
              <th class="sticky-top" scope='col'>Package No.</th>
              <th class="sticky-top" scope='col'>IPC No.</th>
              <th class="sticky-top text-center" scope='col'>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of ipcList | search:'projectShortName,projectPackage,ipcNo':tblSearch let i=index">
              <td class="text-center">{{i+1}}</td>
              <td>{{item.projectShortName}}</td>
              <td>{{item.projectPackage}}</td>
              <td>{{item.ipcNo}}</td>
              <td class='inline-block text-center'>
                <span class='fa fa-info-circle cursorPointer pr-3' (click)="getIPCDetail(item.ipcRefID)"></span>
                <span class='fa fa-edit cursorPointer pr-3 text-primary' (click)="edit(item)"></span>
                <span class='fa fa-trash-o cursorPointer text-danger pr-3' (click)="delete(item)"></span>
              </td>
            </tr>
          </tbody>
        </table>
      </div><!-- End -->
    </div>
  </div>
</div>

<!-- ipc detail Modal -->
<div class="modal animate__animated animate__bounceIn" id="ipcDetailModal">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h3 class="modal-title">IPC Detail</h3>
        <button type="button" class="close" data-dismiss="modal" (click)="clear()">
          &times;
        </button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <div class="loader h-100" style="height: 100% !important;" *ngIf="modalLoadingBar">Loading...</div>

        <div *ngIf="!modalLoadingBar">
          <div class="row">
            <div class="col-md-12">
              <mat-form-field class="w-100">
                <mat-label>Asset - Category</mat-label>
                <mat-select [(ngModel)]="cmbAssetCat" (ngModelChange)="getAssetCatDescription(cmbAssetCat)">
                  <mat-option>
                    <ngx-mat-select-search [(ngModel)]="searchCategory" [placeholderLabel]="'Search...'"
                      [noEntriesFoundLabel]="'Not found'" name="search"></ngx-mat-select-search>
                  </mat-option>

                  <mat-option *ngFor="
                      let item of AssetCatList
                        | search: 'assetCatDescription':searchCategory
                    " [value]="item.assetCatID">
                    {{ item.assetCatDescription }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
          <div class="row" *ngIf="lblAccCategory != ''">
            <div class="col-md-12">
              <div class="row">
                <div class="col-md-5">
                  <label class="align-self-center">Account Category:</label>
                </div>
                <div class="col-md-7 text-left">
                  <label
                    class="align-self-center text-primary font-weight-bold border-bottom">{{ lblAccCategory }}</label>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <mat-form-field class="w-100">
                <mat-label>Quantity</mat-label>
                <input matInput [(ngModel)]="txtQty">
              </mat-form-field>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <mat-form-field class="w-100">
                <mat-label>Description</mat-label>
                <input matInput [(ngModel)]="txtDesc">
              </mat-form-field>
            </div>
          </div>
          <div class="row">
            <div class="col-md-3 pt-2">
              <button mat-button mat-raised-button color="primary" class='noneOutline w-100'
                (click)="saveDetail()">Save</button>
            </div>
            <div class="col-md-3 pt-2">
              <button mat-button mat-raised-button color="warn" class='noneOutline w-100'
                (click)="clearDetail()">Reset</button>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12 pt-2">
              <mat-form-field class="w-100">
                <mat-label>search...</mat-label>
                <mat-icon matPrefix class='fa fa-search' [(ngModel)]="tblSearchDetail"></mat-icon>
                <input matInput>
              </mat-form-field>
            </div>
          </div>
          <div class="table-responsive border table-wrapper mx-auto mb-2 style-3" style='height: 450px;'>
            <table class="table table-striped">
              <thead>
                <tr>
                  <th class="sticky-top" scope='col'>#</th>
                  <th class="sticky-top" scope='col'>Project Name</th>
                  <th class="sticky-top" scope='col'>Asset Category</th>
                  <th class="sticky-top" scope='col'>Quantity</th>
                  <th class="sticky-top" scope='col'>Description</th>
                  <th class="sticky-top text-center" scope='col'>Action</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="let item of ipcDetailList | search:'projectShortName,assetCatDescription,qty,description':tblSearchDetail let i=index">
                  <td class="text-center">{{i+1}}</td>
                  <td>{{item.projectShortName}}</td>
                  <td>{{item.assetCatDescription}}</td>
                  <td>{{item.qty}}</td>
                  <td>{{item.description}}</td>
                  <td class='inline-block text-center'>
                    <span class='fa fa-edit cursorPointer pr-3 text-primary' (click)="editDetail(item)"></span>
                    <span class='fa fa-trash-o cursorPointer text-danger pr-3' (click)="deleteDetail(item)"></span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div><!-- End -->
        </div>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">
          Close
        </button>
      </div>
    </div>
  </div>
</div>
